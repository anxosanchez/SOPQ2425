{"title":"Cálculo da constante de eqilibrio e as concentracións mediante a minimizaci´lln da enerxía libre de Gibbs","markdown":{"yaml":{"title":"Cálculo da constante de eqilibrio e as concentracións mediante a minimizaci´lln da enerxía libre de Gibbs","format":"html","autor":"Anxo Sánchez","lang":"es"},"headingText":"Solución","containsRefs":false,"markdown":"\n\nCalcular as composicións no equilibrio a 1000 K e 1 bar para a reacción de intercambio gas auga (WGS) para unha limentación equimolar de CO e H<sub>2</sub>O usando:\n- a minimización da enexía libre de Gibbs\n- o grao de avance da reacción.\n\nPara o cálculo das funcióons termodimmámicas usa os **polinomios de Shomate**.\n\nConsultado a base de datos do Nist temos os valores eequiridos para resolver o problema. \n\nCO  \n$\\Delta H_{f,gas}^o$\t= -110.53 kJ·mol<sup>-1</sup>  \n$S^o$_{gas}$ = 197.66 J·mol<sup>-1</sup>·K<sup>-1</sup>  \nCO<sub>2</sub>    \n$\\Delta H_{f,gas}^o$\t= -393.51 kJ·mol<sup>-1</sup>  \n$S^o$_{gas}$ = 213.79 J·mol<sup>-1</sup>·K<sup>-1</sup>  \t\nH<sub>2</sub>  \n$S^o$_{gas}$ = 130.68 J·mol<sup>-1</sup>·K<sup>-1</sup>\t \nH<sub>2</sub>O  \n$\\Delta H_{f,gas}^o$ = -241.83k J·mol<sup>-1</sup>  \n$S^o$_{gas}$ = 188.84 J·mol<sup>-1</sup>·K<sup>-1</sup>\n  \nRecordamos as as ecuación de Shomate baseadas en 8 termos A, B, C, D, E, F, G, H, que permiten calcular varios parámetros termodinámicos:\n  \n$$\n\\beg]in{align*}\nC^o_p & = & A + B t + C t^2 + D t^3 + \\frac{E}{t^2} \\\\\nH^o − H°_{298.15} & = & At + B \\frac{B}{\\frac {t^2} {2}} + C \\frac{C}{\\frac {t^3} {3}} + D \\frac{D}{\\frac {t^4} {4}} − \\frac{E}{t^2} + F − H\nS^o = A \\ln(t) + B t + C \\frac{t^2}{2} + D \\frac{t^3}{3} − \\frac{E}{2t^2} + G\n\\end{align*}\n$$\n  \nonde:  \n- Cp = capacidade calorífica (J/mol*K).  \n- H° = enthalpía estándar (kJ/mol).  \n- S° = enthalpía estándar (J/mol*K).  \n- t = temperatura (K) / 1000.\n\nComo a temperatura do problema é de 1000 K, tomaremos o primeiro conxunto de datos.\n\n| CO | CO2 | H2 | H2O |\n| ---------: | ---------: | ---------: | ---------: | \n| A\t| 25.56759 | 24.99735 | 33.066178 |  30.09200 |  \n| B\t| 6.096130 | 55.18696 | -11.363417 | 6.832514 |  \n| C\t| 4.054656 | -33.69137 | 11.432816 | 6.793435 |    \n| D\t| -2.671301 | 7.948387 | -2.772874 | -2.534480 |   \n| E\t| 0.131021 | -0.136638 | -0.158558 | 0.082139 |   \n| F\t| -118.0089 | -403.6075 | -9.980797 | -250.8810 |  \n| G\t| 227.3665 | 228.2431 | 172.707974 | 223.3967 |  \n| H\t| -110.5271 | -393.5224 | 0.0 | -241.8264 |   \n\n\n- Primeriro teremos que definir as constantes e os datos do problema\n\n```{python}\nimport numpy as np\n\nT = 1000  # K\nR = 8.314e-3 # kJ/mol/K\n\nP = 1.0 # bar, a presión total do sistema\nP0 = 1.0 # bar, presión do estado estándar\n\nespecies = ['CO', 'CO2', 'H2', 'H2O']\n\n# Entalpías de formación at 298.15 K sacadas do NIST Webbook\n\nHf298 = [\n    -110.53,  # CO\n    -241.826, # H2O\n    -393.51,  # CO2\n       0.0]   # H2\n\n# Parámetros das ecuacións de Shomate para cada especie\n#           A          B           C          D          E            F          G       H\nWB = [[25.56759,  6.096130,     4.054656,  -2.671301,  0.131021, -118.0089, 227.3665,   -110.5271],  # CO\n      [30.09200,  6.832514,     6.793435,  -2.534480,  0.082139, -250.8810, 223.3967,   -241.8264],  # H2O\n      [24.99735,  55.18696,   -33.69137,    7.948387, -0.136638, -403.6075, 228.2431,   -393.5224],  # CO2\n      [33.066178, -11.363417,  11.432816,  -2.772874, -0.158558, -9.980797, 172.707974,    0.0]]     # H2\n\nWB = np.array(WB)\n\n# Ecuacións de Shomate\n\nt = T/1000\nT_H = np.array([t,  t**2 / 2.0, t**3 / 3.0, t**4 / 4.0, -1.0 / t, 1.0, 0.0, -1.0])\nT_S = np.array([np.log(t), t,  t**2 / 2.0,  t**3 / 3.0, -1.0 / (2.0 * t**2), 0.0, 1.0, 0.0])\n\nH = np.dot(WB, T_H)        # (H - H_298.15) kJ/mol\nS = np.dot(WB, T_S/1000.0) # entropía absoluta kJ/mol/K\n\nGio = Hf298 + H - T * S      # Gibbs energy of each component at 1000 K\n```\n\nAgora, construimos a función da enerxía libre de Gibbs, contabilizando o cambio na actividade debido aos cambios de concentración (mestura ideal).\n\n```{python}\ndef func(ni):\n    ni = np.array(ni)\n    sumni = np.sum(ni)\n    Gi =  Gio / ( R * T ) + np.log( ni / sumni * P / P0 )\n    return np.dot(ni, Gi)\n```\n\nImpoñemos a restrición da conservación dos átomos desde as condicións iniciais ata a distribución no equilibrio das especies. Estas restricións teñen a forma de un sistema de ecuacións:\n  \n$$\nA_{equil} = b_{equil}\n$$\n  \nonde $n$ é o vector que contén o número de moles de cada especie.\n\n```{python}\nAeq = np.array([[ 1,    0,    1,    0],  # balance C \n                [ 1,    1,    2,    0],  # balance O \n                [ 0,    2,    0,    2]]) # balance H \n\n# alimentación equimolar de 1 mol de H2O e 1 mol de CO\nbeq = np.array([1,  # moles de C na alimentación\n                2,  # moles de O na alimentación\n                2]) # moles de H na alimentación\n```\n\nDefinimos a funxión de conservación de átomos:\n\n```{python}\ndef ec1(ni):\n    'condición da lei de conservación dos átoms'\n    return np.dot(Aeq, ni) - beq\n```\n\nAgora xa podemos resolver. O podemos facer con 'fmin_slsqp' \n\n```{python}\nfrom scipy.optimize import fmin_slsqp \n\nn0 = [0.5, 0.5, 0.5, 0.5]  # supoñemos valores iniciais\nN = fmin_slsqp(func, n0, f_eqcons=ec1)\nprint(N)\n```\n\n# Cálculo das fraccións molares e presións parciais\n\nAs presións aquí están de bo acordo coas presións atopadas por outros métodos. O desacordo menor (no terceiro ou cuarto lugar decimal) é probable debido ás tolerancias de converxencia nos distintos algoritmos empregados.\n\n```{python}\nyi = N / np.sum(N)\nPi = yi * P\n\nfor s, y, p in zip(especies, yi, Pi):\n    print('{0:10s}: {1:1.4f} {2:1.4f}'.format(s, y, p))\n```\n\n# Constantes de equilibrio informático\n\nPodemos calcular a constante de equilibrio para a reacción:\n\nCO + H<sub>2</sub>O ⇌ CO<sub>2</sub> + H<sub>2</sub>\n\n```{python}\nnui = np.array([-1, -1, 1, 1])  # coeficientes estequiométricos da reacción\nK = np.prod(yi**nui)\nprint(K)\n```\n","srcMarkdownNoYaml":"\n\nCalcular as composicións no equilibrio a 1000 K e 1 bar para a reacción de intercambio gas auga (WGS) para unha limentación equimolar de CO e H<sub>2</sub>O usando:\n- a minimización da enexía libre de Gibbs\n- o grao de avance da reacción.\n\nPara o cálculo das funcióons termodimmámicas usa os **polinomios de Shomate**.\n\nConsultado a base de datos do Nist temos os valores eequiridos para resolver o problema. \n\nCO  \n$\\Delta H_{f,gas}^o$\t= -110.53 kJ·mol<sup>-1</sup>  \n$S^o$_{gas}$ = 197.66 J·mol<sup>-1</sup>·K<sup>-1</sup>  \nCO<sub>2</sub>    \n$\\Delta H_{f,gas}^o$\t= -393.51 kJ·mol<sup>-1</sup>  \n$S^o$_{gas}$ = 213.79 J·mol<sup>-1</sup>·K<sup>-1</sup>  \t\nH<sub>2</sub>  \n$S^o$_{gas}$ = 130.68 J·mol<sup>-1</sup>·K<sup>-1</sup>\t \nH<sub>2</sub>O  \n$\\Delta H_{f,gas}^o$ = -241.83k J·mol<sup>-1</sup>  \n$S^o$_{gas}$ = 188.84 J·mol<sup>-1</sup>·K<sup>-1</sup>\n  \nRecordamos as as ecuación de Shomate baseadas en 8 termos A, B, C, D, E, F, G, H, que permiten calcular varios parámetros termodinámicos:\n  \n$$\n\\beg]in{align*}\nC^o_p & = & A + B t + C t^2 + D t^3 + \\frac{E}{t^2} \\\\\nH^o − H°_{298.15} & = & At + B \\frac{B}{\\frac {t^2} {2}} + C \\frac{C}{\\frac {t^3} {3}} + D \\frac{D}{\\frac {t^4} {4}} − \\frac{E}{t^2} + F − H\nS^o = A \\ln(t) + B t + C \\frac{t^2}{2} + D \\frac{t^3}{3} − \\frac{E}{2t^2} + G\n\\end{align*}\n$$\n  \nonde:  \n- Cp = capacidade calorífica (J/mol*K).  \n- H° = enthalpía estándar (kJ/mol).  \n- S° = enthalpía estándar (J/mol*K).  \n- t = temperatura (K) / 1000.\n\nComo a temperatura do problema é de 1000 K, tomaremos o primeiro conxunto de datos.\n\n| CO | CO2 | H2 | H2O |\n| ---------: | ---------: | ---------: | ---------: | \n| A\t| 25.56759 | 24.99735 | 33.066178 |  30.09200 |  \n| B\t| 6.096130 | 55.18696 | -11.363417 | 6.832514 |  \n| C\t| 4.054656 | -33.69137 | 11.432816 | 6.793435 |    \n| D\t| -2.671301 | 7.948387 | -2.772874 | -2.534480 |   \n| E\t| 0.131021 | -0.136638 | -0.158558 | 0.082139 |   \n| F\t| -118.0089 | -403.6075 | -9.980797 | -250.8810 |  \n| G\t| 227.3665 | 228.2431 | 172.707974 | 223.3967 |  \n| H\t| -110.5271 | -393.5224 | 0.0 | -241.8264 |   \n\n# Solución\n\n- Primeriro teremos que definir as constantes e os datos do problema\n\n```{python}\nimport numpy as np\n\nT = 1000  # K\nR = 8.314e-3 # kJ/mol/K\n\nP = 1.0 # bar, a presión total do sistema\nP0 = 1.0 # bar, presión do estado estándar\n\nespecies = ['CO', 'CO2', 'H2', 'H2O']\n\n# Entalpías de formación at 298.15 K sacadas do NIST Webbook\n\nHf298 = [\n    -110.53,  # CO\n    -241.826, # H2O\n    -393.51,  # CO2\n       0.0]   # H2\n\n# Parámetros das ecuacións de Shomate para cada especie\n#           A          B           C          D          E            F          G       H\nWB = [[25.56759,  6.096130,     4.054656,  -2.671301,  0.131021, -118.0089, 227.3665,   -110.5271],  # CO\n      [30.09200,  6.832514,     6.793435,  -2.534480,  0.082139, -250.8810, 223.3967,   -241.8264],  # H2O\n      [24.99735,  55.18696,   -33.69137,    7.948387, -0.136638, -403.6075, 228.2431,   -393.5224],  # CO2\n      [33.066178, -11.363417,  11.432816,  -2.772874, -0.158558, -9.980797, 172.707974,    0.0]]     # H2\n\nWB = np.array(WB)\n\n# Ecuacións de Shomate\n\nt = T/1000\nT_H = np.array([t,  t**2 / 2.0, t**3 / 3.0, t**4 / 4.0, -1.0 / t, 1.0, 0.0, -1.0])\nT_S = np.array([np.log(t), t,  t**2 / 2.0,  t**3 / 3.0, -1.0 / (2.0 * t**2), 0.0, 1.0, 0.0])\n\nH = np.dot(WB, T_H)        # (H - H_298.15) kJ/mol\nS = np.dot(WB, T_S/1000.0) # entropía absoluta kJ/mol/K\n\nGio = Hf298 + H - T * S      # Gibbs energy of each component at 1000 K\n```\n\nAgora, construimos a función da enerxía libre de Gibbs, contabilizando o cambio na actividade debido aos cambios de concentración (mestura ideal).\n\n```{python}\ndef func(ni):\n    ni = np.array(ni)\n    sumni = np.sum(ni)\n    Gi =  Gio / ( R * T ) + np.log( ni / sumni * P / P0 )\n    return np.dot(ni, Gi)\n```\n\nImpoñemos a restrición da conservación dos átomos desde as condicións iniciais ata a distribución no equilibrio das especies. Estas restricións teñen a forma de un sistema de ecuacións:\n  \n$$\nA_{equil} = b_{equil}\n$$\n  \nonde $n$ é o vector que contén o número de moles de cada especie.\n\n```{python}\nAeq = np.array([[ 1,    0,    1,    0],  # balance C \n                [ 1,    1,    2,    0],  # balance O \n                [ 0,    2,    0,    2]]) # balance H \n\n# alimentación equimolar de 1 mol de H2O e 1 mol de CO\nbeq = np.array([1,  # moles de C na alimentación\n                2,  # moles de O na alimentación\n                2]) # moles de H na alimentación\n```\n\nDefinimos a funxión de conservación de átomos:\n\n```{python}\ndef ec1(ni):\n    'condición da lei de conservación dos átoms'\n    return np.dot(Aeq, ni) - beq\n```\n\nAgora xa podemos resolver. O podemos facer con 'fmin_slsqp' \n\n```{python}\nfrom scipy.optimize import fmin_slsqp \n\nn0 = [0.5, 0.5, 0.5, 0.5]  # supoñemos valores iniciais\nN = fmin_slsqp(func, n0, f_eqcons=ec1)\nprint(N)\n```\n\n# Cálculo das fraccións molares e presións parciais\n\nAs presións aquí están de bo acordo coas presións atopadas por outros métodos. O desacordo menor (no terceiro ou cuarto lugar decimal) é probable debido ás tolerancias de converxencia nos distintos algoritmos empregados.\n\n```{python}\nyi = N / np.sum(N)\nPi = yi * P\n\nfor s, y, p in zip(especies, yi, Pi):\n    print('{0:10s}: {1:1.4f} {2:1.4f}'.format(s, y, p))\n```\n\n# Constantes de equilibrio informático\n\nPodemos calcular a constante de equilibrio para a reacción:\n\nCO + H<sub>2</sub>O ⇌ CO<sub>2</sub> + H<sub>2</sub>\n\n```{python}\nnui = np.array([-1, -1, 1, 1])  # coeficientes estequiométricos da reacción\nK = np.prod(yi**nui)\nprint(K)\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":false,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"es","fig-responsive":true,"quarto-version":"1.7.1","editor":"visual","theme":{"dark":["solar","../../theme-dark.scss"],"light":["cosmo","../../theme.scss"]},"header-includes":["<link rel=\"stylesheet\" media=\"screen\" href=\"https://fontlibrary.org//face/tex-gyre-adventor\" type=\"text/css\"/>\n"],"code-copy":true,"title-block-banner":true,"title":"Cálculo da constante de eqilibrio e as concentracións mediante a minimizaci´lln da enerxía libre de Gibbs","autor":"Anxo Sánchez"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}